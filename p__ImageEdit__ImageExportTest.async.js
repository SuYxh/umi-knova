(self.webpackChunk=self.webpackChunk||[]).push([[552],{57645:function(U,C,e){"use strict";e.r(C);var u=e(97857),O=e.n(u),i=e(5574),s=e.n(i),d=e(13769),l=e.n(d),n=e(62435),g=e(79566),P=e(84420),b=e.n(P),r=e(86074),j=["src","stageWidth","stageHeight","rotation","setImgRef"],_="https://qn.huat.xyz/mac/202406051057150.jpeg",M=function(a){var L=a.src,h=a.stageWidth,c=a.stageHeight,W=a.rotation,v=a.setImgRef,R=l()(a,j),k=b()(L,"anonymous"),y=s()(k,1),o=y[0],t=(0,n.useRef)(null),A=(0,n.useState)({width:0,height:0,x:0,y:0}),I=s()(A,2),f=I[0],x=I[1];return(0,n.useEffect)(function(){if(o){var B=Math.min(h,c),T=Math.max(o.width,o.height),D=B/T*.8,m=o.width*D,K=o.height*D;x({width:m,height:K,x:h/2,y:c/2})}v(t.current)},[o,h,c,v]),(0,r.jsx)(g.Ee,O()(O()({ref:t,image:o,rotation:W,offsetX:f.width/2,offsetY:f.height/2},f),R))};function p(){var E=600,a=500,L=(0,n.useState)(0),h=s()(L,2),c=h[0],W=h[1],v=(0,n.useRef)(null),R=(0,n.useRef)(null),k=function(t){v.current=t},y=function(){if(v.current&&R.current){var t=v.current,A=t.scaleX(),I=t.scaleY(),f=t.width()*A,x=t.height()*I,B=t.x()-f/2,T=t.y()-x/2,D=R.current.toDataURL({x:B,y:T,width:f,height:x,pixelRatio:2}),m=document.createElement("a");m.download="cropped-image.png",m.href=D,document.body.appendChild(m),m.click(),document.body.removeChild(m)}};return(0,r.jsxs)("div",{style:{width:"600px",height:"auto",border:"1px solid black"},children:[(0,r.jsx)("input",{type:"range",min:"0",max:"360",value:c,onChange:function(t){return W(Number(t.target.value))},style:{marginBottom:"10px"}}),(0,r.jsx)("button",{type:"button",onClick:y,style:{marginBottom:"10px"},children:"\u5BFC\u51FA\u5E26\u5706\u5F62\u7684\u56FE\u7247"}),(0,r.jsx)(g.Hf,{width:E,height:a,children:(0,r.jsxs)(g.mh,{ref:R,children:[(0,r.jsx)(M,{src:_,stageWidth:E,stageHeight:a,rotation:c,setImgRef:k}),(0,r.jsx)(g.Cd,{x:E/2,y:a/2,radius:50,fill:"red",stroke:"black",strokeWidth:4})]})})]})}C.default=p},84420:function(U,C,e){var u=e(62435);U.exports=function(i,s,d){const l=u.useRef("loading"),n=u.useRef(),[g,P]=u.useState(0),b=u.useRef(),r=u.useRef(),j=u.useRef();return(b.current!==i||r.current!==s||j.current!==d)&&(l.current="loading",n.current=void 0,b.current=i,r.current=s,j.current=d),u.useLayoutEffect(function(){if(!i)return;var _=document.createElement("img");function M(){l.current="loaded",n.current=_,P(Math.random())}function p(){l.current="failed",n.current=void 0,P(Math.random())}return _.addEventListener("load",M),_.addEventListener("error",p),s&&(_.crossOrigin=s),d&&(_.referrerPolicy=d),_.src=i,function(){_.removeEventListener("load",M),_.removeEventListener("error",p)}},[i,s,d]),[n.current,l.current]}}}]);
