(self.webpackChunk=self.webpackChunk||[]).push([[789],{75217:function(U,j,e){"use strict";e.r(j);var u=e(26068),O=e.n(u),i=e(48305),s=e.n(i),d=e(67825),l=e.n(d),n=e(93236),g=e(53531),p=e(97629),P=e.n(p),_=e(62086),b=["src","stageWidth","stageHeight","rotation","setImgRef"],r="https://qn.huat.xyz/mac/202406051057150.jpeg",M=function(a){var L=a.src,h=a.stageWidth,c=a.stageHeight,W=a.rotation,v=a.setImgRef,R=l()(a,b),k=P()(L,"anonymous"),y=s()(k,1),o=y[0],t=(0,n.useRef)(null),A=(0,n.useState)({width:0,height:0,x:0,y:0}),x=s()(A,2),f=x[0],D=x[1];return(0,n.useEffect)(function(){if(o){var B=Math.min(h,c),T=Math.max(o.width,o.height),C=B/T*.8,m=o.width*C,K=o.height*C;D({width:m,height:K,x:h/2,y:c/2})}v(t.current)},[o,h,c,v]),(0,_.jsx)(g.Ee,O()(O()({ref:t,image:o,rotation:W,offsetX:f.width/2,offsetY:f.height/2},f),R))};function I(){var E=600,a=500,L=(0,n.useState)(0),h=s()(L,2),c=h[0],W=h[1],v=(0,n.useRef)(null),R=(0,n.useRef)(null),k=function(t){v.current=t},y=function(){if(v.current&&R.current){var t=v.current,A=t.scaleX(),x=t.scaleY(),f=t.width()*A,D=t.height()*x,B=t.x()-f/2,T=t.y()-D/2,C=R.current.toDataURL({x:B,y:T,width:f,height:D,pixelRatio:2}),m=document.createElement("a");m.download="cropped-image.png",m.href=C,document.body.appendChild(m),m.click(),document.body.removeChild(m)}};return(0,_.jsxs)("div",{style:{width:"600px",height:"auto",border:"1px solid black"},children:[(0,_.jsx)("input",{type:"range",min:"0",max:"360",value:c,onChange:function(t){return W(Number(t.target.value))},style:{marginBottom:"10px"}}),(0,_.jsx)("button",{type:"button",onClick:y,style:{marginBottom:"10px"},children:"\u5BFC\u51FA\u5E26\u5706\u5F62\u7684\u56FE\u7247"}),(0,_.jsx)(g.Hf,{width:E,height:a,children:(0,_.jsxs)(g.mh,{ref:R,children:[(0,_.jsx)(M,{src:r,stageWidth:E,stageHeight:a,rotation:c,setImgRef:k}),(0,_.jsx)(g.Cd,{x:E/2,y:a/2,radius:50,fill:"red",stroke:"black",strokeWidth:4})]})})]})}j.default=I},97629:function(U,j,e){var u=e(93236);U.exports=function(i,s,d){const l=u.useRef("loading"),n=u.useRef(),[g,p]=u.useState(0),P=u.useRef(),_=u.useRef(),b=u.useRef();return(P.current!==i||_.current!==s||b.current!==d)&&(l.current="loading",n.current=void 0,P.current=i,_.current=s,b.current=d),u.useLayoutEffect(function(){if(!i)return;var r=document.createElement("img");function M(){l.current="loaded",n.current=r,p(Math.random())}function I(){l.current="failed",n.current=void 0,p(Math.random())}return r.addEventListener("load",M),r.addEventListener("error",I),s&&(r.crossOrigin=s),d&&(r.referrerPolicy=d),r.src=i,function(){r.removeEventListener("load",M),r.removeEventListener("error",I)}},[i,s,d]),[n.current,l.current]}}}]);
