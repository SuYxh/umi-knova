(self.webpackChunk=self.webpackChunk||[]).push([[432],{40115:function(D,S,c){"use strict";c.r(S),c.d(S,{default:function(){return l}});var u=c(53531),s=c(93236),f=c(92628),d=c(39363),v=function(t,r){var a={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.indexOf(n)<0&&(a[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)r.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(a[n[o]]=t[n[o]]);return a};const p=t=>{const r=window.getComputedStyle(t).position;return!(r==="absolute"||r==="relative")};function g(t=()=>{}){const r=s.useRef(t);return r.current=t,s.useCallback((...a)=>r.current.apply(null,a),[])}const M=({children:t,groupProps:r,divProps:a,transform:n,transformFunc:o})=>{const O=(0,d.jn)(),m=s.useRef(null),b=s.useRef(),[e]=s.useState(()=>document.createElement("div")),j=s.useMemo(()=>f.createRoot(e),[e]),h=n!=null?n:!0,C=g(()=>{if(h&&m.current){let y=m.current.getAbsoluteTransform().decompose();o&&(y=o(y)),e.style.position="absolute",e.style.zIndex="10",e.style.top="0px",e.style.left="0px",e.style.transform=`translate(${y.x}px, ${y.y}px) rotate(${y.rotation}deg) scaleX(${y.scaleX}) scaleY(${y.scaleY})`,e.style.transformOrigin="top left"}else e.style.position="",e.style.zIndex="",e.style.top="",e.style.left="",e.style.transform="",e.style.transformOrigin="";const R=a||{},{style:x}=R,E=v(R,["style"]);Object.assign(e.style,x),Object.assign(e,E)});return s.useLayoutEffect(()=>{var R;const x=m.current;if(!x)return;const E=(R=x.getStage())===null||R===void 0?void 0:R.container();if(E)return E.appendChild(e),h&&p(E)&&(E.style.position="relative"),x.on("absoluteTransformChange",C),C(),()=>{var w;x.off("absoluteTransformChange",C),(w=e.parentNode)===null||w===void 0||w.removeChild(e)}},[h]),s.useLayoutEffect(()=>{C()},[a,o]),s.useLayoutEffect(()=>{j.render(s.createElement(O,null,t))}),s.useLayoutEffect(()=>()=>{setTimeout(()=>{j.unmount()})},[]),s.createElement(u.ZA,Object.assign({ref:m},r))},T=({selector:t,enabled:r,children:a})=>{const n=React.useRef(null),o=React.useRef(null),O=React.useRef(),m=r!=null?r:!0;return React.useLayoutEffect(()=>{if(!n.current||!o.current)return;O.current=o.current;const e=n.current.getStage().findOne(t);m&&e?o.current.moveTo(e):o.current.moveTo(n.current);const j=n.current.getLayer();if(j&&(j.batchDraw(),e)){const h=e.getLayer();if(!h)return;h.batchDraw()}},[t,m]),React.useEffect(()=>()=>{var b;(b=O.current)===null||b===void 0||b.destroy()},[]),React.createElement(Group,{name:"_outer_portal",ref:n},React.createElement(Group,{name:"_inner_portal",ref:o},a))};var P=c(97629),i=c(62086);function L(){return(0,i.jsx)("div",{style:{width:"600px",height:"500px",border:"1px solid black"},children:(0,i.jsx)(u.Hf,{width:600,height:500,children:(0,i.jsxs)(u.mh,{children:[(0,i.jsx)(M,{divProps:{style:{position:"absolute",top:10,left:10}},children:(0,i.jsx)("input",{placeholder:"DOM input from Konva nodes"})}),(0,i.jsx)(u.UL,{x:20,y:20,width:50,height:50,fill:"red",shadowBlur:5})]})})})}var l=L},97629:function(D,S,c){var u=c(93236);D.exports=function(f,d,v){const p=u.useRef("loading"),g=u.useRef(),[M,T]=u.useState(0),P=u.useRef(),i=u.useRef(),L=u.useRef();return(P.current!==f||i.current!==d||L.current!==v)&&(p.current="loading",g.current=void 0,P.current=f,i.current=d,L.current=v),u.useLayoutEffect(function(){if(!f)return;var l=document.createElement("img");function t(){p.current="loaded",g.current=l,T(Math.random())}function r(){p.current="failed",g.current=void 0,T(Math.random())}return l.addEventListener("load",t),l.addEventListener("error",r),d&&(l.crossOrigin=d),v&&(l.referrerPolicy=v),l.src=f,function(){l.removeEventListener("load",t),l.removeEventListener("error",r)}},[f,d,v]),[g.current,p.current]}}}]);
